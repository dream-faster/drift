
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Dream Faster" name="author"/>
<link href="../core_walkthrough/" rel="prev"/>
<link href="../../generated/gallery/" rel="next"/>
<link href="../../images/logo.svg" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.5.12" name="generator"/>
<title>Benchmarking Sktime-Fold - Fold</title>
<link href="../../assets/stylesheets/main.7e359304.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<link href="../../sg_gallery-rendered-html.css" rel="stylesheet"/>
<link href="../../sg_gallery-binder.css" rel="stylesheet"/>
<link href="../../sg_gallery.css" rel="stylesheet"/>
<link href="../../sg_gallery-dataframe.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-FBLB9N9026"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-FBLB9N9026",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-FBLB9N9026",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
<script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="amber" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#benchmarking-the-speed-of-fold-and-sktime">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Fold" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Fold">
<img alt="logo" src="../../images/logo_white.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Fold
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Benchmarking Sktime-Fold
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="deep-orange" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="amber" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="deep-orange" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="amber" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/dream-faster/fold" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Fold" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Fold">
<img alt="logo" src="../../images/logo_white.svg"/>
</a>
    Fold
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/dream-faster/fold" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Must know Concepts
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Must know Concepts
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../concepts/adaptive-ml/">
<span class="md-ellipsis">
    Adaptive ML
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../concepts/speed/">
<span class="md-ellipsis">
    Speed
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../concepts/design/">
<span class="md-ellipsis">
    Design
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../concepts/models/">
<span class="md-ellipsis">
    Models
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../concepts/forecasting-horizon/">
<span class="md-ellipsis">
    Forecasting horizon
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../concepts/splitters/">
<span class="md-ellipsis">
    Splitters
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Walkthroughs
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Walkthroughs
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../core_walkthrough/">
<span class="md-ellipsis">
    Start Here (Core Walkthrough)
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Benchmarking Sktime-Fold
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Benchmarking Sktime-Fold
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#installing-libraries-defining-utility-functions">
<span class="md-ellipsis">
      Installing libraries, defining utility functions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-loading">
<span class="md-ellipsis">
      Data Loading
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sktime-long-forecasting-horizon-time-series-cross-validation">
<span class="md-ellipsis">
      SKTime - Long forecasting horizon (Time Series Cross-Validation)
    </span>
</a>
<nav aria-label="SKTime - Long forecasting horizon (Time Series Cross-Validation)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#naive">
<span class="md-ellipsis">
      Naive
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#statsmodels-arima">
<span class="md-ellipsis">
      Statsmodels ARIMA
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#xgboost">
<span class="md-ellipsis">
      XGBoost
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#results">
<span class="md-ellipsis">
      Results
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fold-short-forecasting-horizon-continuous-validation">
<span class="md-ellipsis">
      Fold - Short forecasting horizon (Continuous Validation)
    </span>
</a>
<nav aria-label="Fold - Short forecasting horizon (Continuous Validation)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#naive_1">
<span class="md-ellipsis">
      Naive
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#statsmodels-arima-online">
<span class="md-ellipsis">
      Statsmodels ARIMA (Online)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#xgboost_1">
<span class="md-ellipsis">
      XGBoost
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#results_1">
<span class="md-ellipsis">
      Results
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sktime-short-forecasting-horizon-continuous-validation">
<span class="md-ellipsis">
      SKTime - Short forecasting horizon (Continuous Validation)
    </span>
</a>
<nav aria-label="SKTime - Short forecasting horizon (Continuous Validation)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#naive_2">
<span class="md-ellipsis">
      Naive
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#statsmodels-arima_1">
<span class="md-ellipsis">
      Statsmodels ARIMA
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#xgboost_2">
<span class="md-ellipsis">
      XGBoost
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#overall-results">
<span class="md-ellipsis">
      Overall Results
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../generated/gallery/">
<span class="md-ellipsis">
    Examples
  </span>
</a>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Examples
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../generated/gallery/date/">
<span class="md-ellipsis">
    Adding Date/Time Features
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../generated/gallery/preprocess/">
<span class="md-ellipsis">
    Preprocessing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../generated/gallery/tabular/">
<span class="md-ellipsis">
    Using Tabular Models
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../generated/gallery/scale/">
<span class="md-ellipsis">
    Scaling the data
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../generated/gallery/transform-target/">
<span class="md-ellipsis">
    Transformations applied to the Target (y)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../generated/gallery/ensembling/">
<span class="md-ellipsis">
    Ensembling (Composite Models)
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../api/">
<span class="md-ellipsis">
    API
  </span>
</a>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            API
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/loop/">
<span class="md-ellipsis">
    Main Loops
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/models/">
<span class="md-ellipsis">
    Models
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/composites/">
<span class="md-ellipsis">
    Composites
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/transformations/">
<span class="md-ellipsis">
    Transformations
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    Product, Licencing &amp; Roadmap
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Product, Licencing &amp; Roadmap
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../product/pricing/">
<span class="md-ellipsis">
    Pricing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../product/license/">
<span class="md-ellipsis">
    License
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../product/roadmap/">
<span class="md-ellipsis">
    Roadmap
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#installing-libraries-defining-utility-functions">
<span class="md-ellipsis">
      Installing libraries, defining utility functions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-loading">
<span class="md-ellipsis">
      Data Loading
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sktime-long-forecasting-horizon-time-series-cross-validation">
<span class="md-ellipsis">
      SKTime - Long forecasting horizon (Time Series Cross-Validation)
    </span>
</a>
<nav aria-label="SKTime - Long forecasting horizon (Time Series Cross-Validation)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#naive">
<span class="md-ellipsis">
      Naive
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#statsmodels-arima">
<span class="md-ellipsis">
      Statsmodels ARIMA
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#xgboost">
<span class="md-ellipsis">
      XGBoost
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#results">
<span class="md-ellipsis">
      Results
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fold-short-forecasting-horizon-continuous-validation">
<span class="md-ellipsis">
      Fold - Short forecasting horizon (Continuous Validation)
    </span>
</a>
<nav aria-label="Fold - Short forecasting horizon (Continuous Validation)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#naive_1">
<span class="md-ellipsis">
      Naive
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#statsmodels-arima-online">
<span class="md-ellipsis">
      Statsmodels ARIMA (Online)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#xgboost_1">
<span class="md-ellipsis">
      XGBoost
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#results_1">
<span class="md-ellipsis">
      Results
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sktime-short-forecasting-horizon-continuous-validation">
<span class="md-ellipsis">
      SKTime - Short forecasting horizon (Continuous Validation)
    </span>
</a>
<nav aria-label="SKTime - Short forecasting horizon (Continuous Validation)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#naive_2">
<span class="md-ellipsis">
      Naive
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#statsmodels-arima_1">
<span class="md-ellipsis">
      Statsmodels ARIMA
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#xgboost_2">
<span class="md-ellipsis">
      XGBoost
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#overall-results">
<span class="md-ellipsis">
      Overall Results
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="benchmarking-the-speed-of-fold-and-sktime">Benchmarking the speed of <a href="https://github.com/dream-faster/fold">fold</a> and SKTime.</h1>
<p><a class="md-button" href="../benchmarking_sktime_fold.ipynb"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7Z"></path></svg></span>  Download</a> <a class="md-button md-button--primary" href="https://colab.research.google.com/drive/1iLXpty-j1kpDCzLM4fCsP3fLoS_DFN1C?usp=sharing"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16.941 4.976a7.033 7.033 0 0 0-4.93 2.064 7.033 7.033 0 0 0-.124 9.807l2.395-2.395a3.646 3.646 0 0 1 5.15-5.148l2.397-2.399a7.033 7.033 0 0 0-4.888-1.93zm-9.871.01a7.033 7.033 0 0 0-4.888 1.931l2.391 2.391a3.643 3.643 0 0 1 5.023.127l1.734-2.973-.1-.08a7.033 7.033 0 0 0-4.16-1.396zm15.01 2.172-2.39 2.39a3.646 3.646 0 0 1-5.15 5.15l-2.406 2.407a7.036 7.036 0 0 0 9.945-9.947zm-20.148.01a7.033 7.033 0 0 0-.002 9.681l2.397-2.397a3.643 3.643 0 0 1-.004-4.892zm7.664 7.423a3.635 3.635 0 0 1-5.017.113L2.182 17.1a7.029 7.029 0 0 0 9.007.546l.137-.112z"></path></svg></span>  Open In Colab</a></p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="Cover Image for Benchmarking" data-type="image" data-width="100%" href="https://lh3.googleusercontent.com/drive-viewer/AAOQEOQ_hiGnfxaCuCDqS5cESXFi3YVEMyqzNUYMg3lwj5a1GgU_sR5h3e1CcP1-OTshHwjHLamQizdt3qtRITdkL5HBePYdKA=s1600"><img alt="Cover Image for Benchmarking" src="https://lh3.googleusercontent.com/drive-viewer/AAOQEOQ_hiGnfxaCuCDqS5cESXFi3YVEMyqzNUYMg3lwj5a1GgU_sR5h3e1CcP1-OTshHwjHLamQizdt3qtRITdkL5HBePYdKA=s1600"/></a></p>
<h2 id="installing-libraries-defining-utility-functions">Installing libraries, defining utility functions</h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="o">%%</span><span class="n">capture</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">quiet</span> <span class="n">fold</span><span class="o">-</span><span class="n">core</span> <span class="n">fold</span><span class="o">-</span><span class="n">models</span> <span class="n">krisi</span> <span class="n">fold</span><span class="o">-</span><span class="n">wrappers</span> <span class="n">matplotlib</span> <span class="n">seaborn</span> <span class="n">xgboost</span> <span class="n">plotly</span> <span class="n">prophet</span> <span class="n">statsforecast</span> <span class="n">statsmodels</span> <span class="n">ray</span> <span class="n">kaleido</span> <span class="n">sktime</span> <span class="n">pmdarima</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">monotonic</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="kn">from</span> <span class="nn">krisi</span> <span class="kn">import</span> <span class="n">score</span>
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="kn">from</span> <span class="nn">krisi.report</span> <span class="kn">import</span> <span class="n">plot_y_predictions</span>
</span><span id="__span-1-6"><a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="kn">import</span> <span class="nn">plotly.io</span> <span class="k">as</span> <span class="nn">pio</span>
</span><span id="__span-1-7"><a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="n">pio</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="s2">"png"</span>
</span><span id="__span-1-8"><a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a>
</span><span id="__span-1-9"><a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="k">class</span> <span class="nc">Timing</span><span class="p">:</span>
</span><span id="__span-1-10"><a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a>    <span class="n">results</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">))</span>
</span><span id="__span-1-11"><a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a>
</span><span id="__span-1-12"><a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a>    <span class="k">def</span> <span class="nf">record_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">framework</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="__span-1-13"><a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a>        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span> <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="__span-1-14"><a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a>            <span class="n">start_time</span> <span class="o">=</span> <span class="n">monotonic</span><span class="p">()</span>
</span><span id="__span-1-15"><a href="#__codelineno-1-15" id="__codelineno-1-15" name="__codelineno-1-15"></a>            <span class="n">return_value</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="__span-1-16"><a href="#__codelineno-1-16" id="__codelineno-1-16" name="__codelineno-1-16"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Run time: </span><span class="si">{</span><span class="n">monotonic</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">}</span><span class="s2"> seconds"</span><span class="p">)</span>
</span><span id="__span-1-17"><a href="#__codelineno-1-17" id="__codelineno-1-17" name="__codelineno-1-17"></a>
</span><span id="__span-1-18"><a href="#__codelineno-1-18" id="__codelineno-1-18" name="__codelineno-1-18"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">framework</span><span class="p">][</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">monotonic</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</span><span id="__span-1-19"><a href="#__codelineno-1-19" id="__codelineno-1-19" name="__codelineno-1-19"></a>            <span class="k">return</span> <span class="n">return_value</span>
</span><span id="__span-1-20"><a href="#__codelineno-1-20" id="__codelineno-1-20" name="__codelineno-1-20"></a>        <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="__span-1-21"><a href="#__codelineno-1-21" id="__codelineno-1-21" name="__codelineno-1-21"></a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-1-22"><a href="#__codelineno-1-22" id="__codelineno-1-22" name="__codelineno-1-22"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.max_rows'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-1-23"><a href="#__codelineno-1-23" id="__codelineno-1-23" name="__codelineno-1-23"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.max_columns'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="__span-1-24"><a href="#__codelineno-1-24" id="__codelineno-1-24" name="__codelineno-1-24"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.colheader_justify'</span><span class="p">,</span> <span class="s1">'center'</span><span class="p">)</span>
</span><span id="__span-1-25"><a href="#__codelineno-1-25" id="__codelineno-1-25" name="__codelineno-1-25"></a>        <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.precision'</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-1-26"><a href="#__codelineno-1-26" id="__codelineno-1-26" name="__codelineno-1-26"></a>        <span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">))</span>
</span><span id="__span-1-27"><a href="#__codelineno-1-27" id="__codelineno-1-27" name="__codelineno-1-27"></a>
</span><span id="__span-1-28"><a href="#__codelineno-1-28" id="__codelineno-1-28" name="__codelineno-1-28"></a><span class="n">timing</span> <span class="o">=</span> <span class="n">Timing</span><span class="p">()</span>
</span><span id="__span-1-29"><a href="#__codelineno-1-29" id="__codelineno-1-29" name="__codelineno-1-29"></a>
</span><span id="__span-1-30"><a href="#__codelineno-1-30" id="__codelineno-1-30" name="__codelineno-1-30"></a><span class="k">def</span> <span class="nf">flatten_result_windows</span><span class="p">(</span><span class="n">series</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
</span><span id="__span-1-31"><a href="#__codelineno-1-31" id="__codelineno-1-31" name="__codelineno-1-31"></a>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</span></code></pre></div>
<h2 id="data-loading">Data Loading</h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kn">from</span> <span class="nn">fold.utils.dataset</span> <span class="kn">import</span> <span class="n">get_preprocessed_dataset</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">get_preprocessed_dataset</span><span class="p">(</span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>    <span class="s2">"weather/historical_hourly_la"</span><span class="p">,</span> <span class="n">target_col</span><span class="o">=</span><span class="s2">"temperature"</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="s2">"H"</span><span class="p">,</span> <span class="n">shorten</span><span class="o">=</span><span class="mi">1000</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="p">)</span>
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">());</span>
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">());</span>
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">y</span><span class="p">,</span><span class="n">X</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">'columns'</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">subplots</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>                     humidity  pressure  wind_speed  wind_direction  \
datetime                                                              
2012-10-01 13:00:00      88.0    1013.0         0.0             0.0   
2012-10-01 14:00:00      88.0    1013.0         0.0             0.0   
2012-10-01 15:00:00      88.0    1013.0         0.0             0.0   
2012-10-01 16:00:00      88.0    1013.0         0.0             0.0   
2012-10-01 17:00:00      88.0    1013.0         0.0             0.0

                     temperature  
datetime                          
2012-10-01 13:00:00   291.870000  
2012-10-01 14:00:00   291.868186  
2012-10-01 15:00:00   291.862844  
2012-10-01 16:00:00   291.857503  
2012-10-01 17:00:00   291.852162  
datetime
2012-10-01 13:00:00    291.868186
2012-10-01 14:00:00    291.862844
2012-10-01 15:00:00    291.857503
2012-10-01 16:00:00    291.852162
2012-10-01 17:00:00    291.846821
Freq: H, Name: temperature, dtype: float64
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="png" data-type="image" data-width="100%" href="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_6_1.png"><img alt="png" src="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_6_1.png"/></a></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># Default values that both sktime and fold will receive</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="n">step_size</span> <span class="o">=</span> <span class="mi">50</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="n">initial_train_size</span> <span class="o">=</span> <span class="mi">300</span>
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="n">lag_length_for_tabular_models</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-3-6"><a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="n">fh</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">step_size</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</span></code></pre></div>
<h2 id="sktime-long-forecasting-horizon-time-series-cross-validation">SKTime - Long forecasting horizon (Time Series Cross-Validation)</h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.model_evaluation</span> <span class="kn">import</span> <span class="n">evaluate</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.model_selection</span> <span class="kn">import</span> <span class="n">ExpandingWindowSplitter</span> <span class="k">as</span> <span class="n">SKTimeExpandingWindowSplitter</span>
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.naive</span> <span class="kn">import</span> <span class="n">NaiveForecaster</span>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.arima</span> <span class="kn">import</span> <span class="n">ARIMA</span>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="kn">from</span> <span class="nn">sktime.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.compose</span> <span class="kn">import</span> <span class="n">make_reduction</span>
</span></code></pre></div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">cv</span> <span class="o">=</span> <span class="n">SKTimeExpandingWindowSplitter</span><span class="p">(</span><span class="n">initial_window</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="n">step_length</span><span class="o">=</span><span class="n">step_size</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="n">fh</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="naive">Naive</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="n">forecaster</span> <span class="o">=</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">"last"</span><span class="p">)</span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="n">results</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">record_time</span><span class="p">(</span><span class="s1">'naive'</span><span class="p">,</span> <span class="s1">'sktime (long-fh)'</span><span class="p">)(</span><span class="n">evaluate</span><span class="p">,</span> <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s1">'raise'</span><span class="p">)</span>
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">flatten_result_windows</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">'y_pred'</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">"naive"</span><span class="p">)</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="n">plot_y_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"overlap"</span><span class="p">)</span>
</span><span id="__span-6-5"><a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="n">score</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)[[</span><span class="s1">'rmse'</span><span class="p">]]</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'minimal'</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Run time: 0.32869669699999804 seconds
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="png" data-type="image" data-width="100%" href="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_12_1.png"><img alt="png" src="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_12_1.png"/></a></p>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">                                            naive
                 Root Mean Squared Error  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.36894</span>
</pre>
<h3 id="statsmodels-arima">Statsmodels ARIMA</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="n">results</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">record_time</span><span class="p">(</span><span class="s1">'arima'</span><span class="p">,</span> <span class="s1">'sktime (long-fh)'</span><span class="p">)(</span><span class="n">evaluate</span><span class="p">,</span> <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s1">'raise'</span><span class="p">)</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">flatten_result_windows</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">'y_pred'</span><span class="p">])</span>
</span><span id="__span-7-5"><a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="n">plot_y_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"overlap"</span><span class="p">)</span>
</span><span id="__span-7-6"><a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="n">score</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)[[</span><span class="s1">'rmse'</span><span class="p">]]</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'minimal'</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Run time: 2.449221571999999 seconds
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="png" data-type="image" data-width="100%" href="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_14_1.png"><img alt="png" src="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_14_1.png"/></a></p>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">                                          temperature
                 Root Mean Squared Error     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6.743475</span>
</pre>
<p>A seasonal ARIMA - not suprisingly - provides much better results, but because of the slowness (and out of memory errors), we couldn't benchmark Statsmodels' implementation.</p>
<h3 id="xgboost">XGBoost</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="n">regressor</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-8-3"><a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>
</span><span id="__span-8-4"><a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="n">forecaster</span> <span class="o">=</span> <span class="n">make_reduction</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">"recursive"</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="n">lag_length_for_tabular_models</span><span class="p">)</span>
</span><span id="__span-8-5"><a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="n">results</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">record_time</span><span class="p">(</span><span class="s1">'xgboost'</span><span class="p">,</span> <span class="s1">'sktime (long-fh)'</span><span class="p">)(</span><span class="n">evaluate</span><span class="p">,</span> <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s2">"multiprocessing"</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s1">'raise'</span><span class="p">)</span>
</span><span id="__span-8-6"><a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">flatten_result_windows</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">'y_pred'</span><span class="p">])</span>
</span><span id="__span-8-7"><a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="n">plot_y_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"overlap"</span><span class="p">)</span>
</span><span id="__span-8-8"><a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="n">score</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)[[</span><span class="s1">'rmse'</span><span class="p">]]</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'minimal'</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Run time: 44.59098899100002 seconds
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="png" data-type="image" data-width="100%" href="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_17_1.png"><img alt="png" src="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_17_1.png"/></a></p>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">                                          temperature
                 Root Mean Squared Error     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5.044424</span>
</pre>
<h3 id="results">Results</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="n">timing</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span></code></pre></div>
<div id="df-9190ebbe-b233-46d8-8e6b-b72c9039b13d">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: center;">
<th></th>
<th>sktime (long-fh)</th>
</tr>
</thead>
<tbody>
<tr>
<th>arima</th>
<td>2.449</td>
</tr>
<tr>
<th>naive</th>
<td>0.329</td>
</tr>
<tr>
<th>xgboost</th>
<td>44.591</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-9190ebbe-b233-46d8-8e6b-b72c9039b13d')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-9190ebbe-b233-46d8-8e6b-b72c9039b13d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9190ebbe-b233-46d8-8e6b-b72c9039b13d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<p>SKTime may look fast on its own, but it definitely falls short when it comes to the real usefulness of Time Series Cross-Validation.</p>
<p>The models are static, stuck in the past between end of the training windows, they don't have access to the latest value, and therefore their predictions are way off.</p>
<h2 id="fold-short-forecasting-horizon-continuous-validation">Fold - Short forecasting horizon (Continuous Validation)</h2>
<p><a href="https://github.com/dream-faster/fold">fold</a> has the ability to update models within the test window, in an "online" manner:</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="100%" href="https://raw.githubusercontent.com/dream-faster/fold/main/docs/images/technical_diagrams/continous_online_inference.svg"><img alt="" src="https://raw.githubusercontent.com/dream-faster/fold/main/docs/images/technical_diagrams/continous_online_inference.svg"/></a></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="kn">from</span> <span class="nn">fold</span> <span class="kn">import</span> <span class="n">train_evaluate</span><span class="p">,</span> <span class="n">ExpandingWindowSplitter</span><span class="p">,</span> <span class="n">BackendType</span>
</span><span id="__span-10-2"><a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="kn">from</span> <span class="nn">fold.transformations</span> <span class="kn">import</span> <span class="n">AddLagsX</span>
</span><span id="__span-10-3"><a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="kn">from</span> <span class="nn">fold.models.wrappers</span> <span class="kn">import</span> <span class="n">WrapXGB</span><span class="p">,</span> <span class="n">WrapStatsModels</span>
</span><span id="__span-10-4"><a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="kn">from</span> <span class="nn">fold.models</span> <span class="kn">import</span> <span class="n">Naive</span>
</span><span id="__span-10-5"><a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="kn">from</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span> <span class="k">as</span> <span class="n">StatsModelARIMA</span>
</span><span id="__span-10-6"><a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="kn">import</span> <span class="nn">ray</span>
</span><span id="__span-10-7"><a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="n">ray</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">ignore_reinit_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>2023-04-17 11:07:04,950 INFO worker.py:1553 -- Started a local Ray instance.
</code></pre></div>
<div>
<div style="margin-left: 50px;display: flex;flex-direction: row;align-items: center">
<h3 style="color: var(--jp-ui-font-color0)">Ray</h3>
<svg id="ray" style="margin-left: 3em;margin-right: 3em" version="1.1" viewbox="0 0 144.5 144.6" width="3em">
<g id="layer-1">
<path class="st0" d="M97.3,77.2c-3.8-1.1-6.2,0.9-8.3,5.1c-3.5,6.8-9.9,9.9-17.4,9.6S58,88.1,54.8,81.2c-1.4-3-3-4-6.3-4.1
                    c-5.6-0.1-9.9,0.1-13.1,6.4c-3.8,7.6-13.6,10.2-21.8,7.6C5.2,88.4-0.4,80.5,0,71.7c0.1-8.4,5.7-15.8,13.8-18.2
                    c8.4-2.6,17.5,0.7,22.3,8c1.3,1.9,1.3,5.2,3.6,5.6c3.9,0.6,8,0.2,12,0.2c1.8,0,1.9-1.6,2.4-2.8c3.5-7.8,9.7-11.8,18-11.9
                    c8.2-0.1,14.4,3.9,17.8,11.4c1.3,2.8,2.9,3.6,5.7,3.3c1-0.1,2,0.1,3,0c2.8-0.5,6.4,1.7,8.1-2.7s-2.3-5.5-4.1-7.5
                    c-5.1-5.7-10.9-10.8-16.1-16.3C84,38,81.9,37.1,78,38.3C66.7,42,56.2,35.7,53,24.1C50.3,14,57.3,2.8,67.7,0.5
                    C78.4-2,89,4.7,91.5,15.3c0.1,0.3,0.1,0.5,0.2,0.8c0.7,3.4,0.7,6.9-0.8,9.8c-1.7,3.2-0.8,5,1.5,7.2c6.7,6.5,13.3,13,19.8,19.7
                    c1.8,1.8,3,2.1,5.5,1.2c9.1-3.4,17.9-0.6,23.4,7c4.8,6.9,4.6,16.1-0.4,22.9c-5.4,7.2-14.2,9.9-23.1,6.5c-2.3-0.9-3.5-0.6-5.1,1.1
                    c-6.7,6.9-13.6,13.7-20.5,20.4c-1.8,1.8-2.5,3.2-1.4,5.9c3.5,8.7,0.3,18.6-7.7,23.6c-7.9,5-18.2,3.8-24.8-2.9
                    c-6.4-6.4-7.4-16.2-2.5-24.3c4.9-7.8,14.5-11,23.1-7.8c3,1.1,4.7,0.5,6.9-1.7C91.7,98.4,98,92.3,104.2,86c1.6-1.6,4.1-2.7,2.6-6.2
                    c-1.4-3.3-3.8-2.5-6.2-2.6C99.8,77.2,98.9,77.2,97.3,77.2z M72.1,29.7c5.5,0.1,9.9-4.3,10-9.8c0-0.1,0-0.2,0-0.3
                    C81.8,14,77,9.8,71.5,10.2c-5,0.3-9,4.2-9.3,9.2c-0.2,5.5,4,10.1,9.5,10.3C71.8,29.7,72,29.7,72.1,29.7z M72.3,62.3
                    c-5.4-0.1-9.9,4.2-10.1,9.7c0,0.2,0,0.3,0,0.5c0.2,5.4,4.5,9.7,9.9,10c5.1,0.1,9.9-4.7,10.1-9.8c0.2-5.5-4-10-9.5-10.3
                    C72.6,62.3,72.4,62.3,72.3,62.3z M115,72.5c0.1,5.4,4.5,9.7,9.8,9.9c5.6-0.2,10-4.8,10-10.4c-0.2-5.4-4.6-9.7-10-9.7
                    c-5.3-0.1-9.8,4.2-9.9,9.5C115,72.1,115,72.3,115,72.5z M19.5,62.3c-5.4,0.1-9.8,4.4-10,9.8c-0.1,5.1,5.2,10.4,10.2,10.3
                    c5.6-0.2,10-4.9,9.8-10.5c-0.1-5.4-4.5-9.7-9.9-9.6C19.6,62.3,19.5,62.3,19.5,62.3z M71.8,134.6c5.9,0.2,10.3-3.9,10.4-9.6
                    c0.5-5.5-3.6-10.4-9.1-10.8c-5.5-0.5-10.4,3.6-10.8,9.1c0,0.5,0,0.9,0,1.4c-0.2,5.3,4,9.8,9.3,10
                    C71.6,134.6,71.7,134.6,71.8,134.6z" fill="#00a2e9"></path>
</g>
</svg>
<table>
<tr>
<td style="text-align: left"><b>Python version:</b></td>
<td style="text-align: left"><b>3.9.16</b></td>
</tr>
<tr>
<td style="text-align: left"><b>Ray version:</b></td>
<td style="text-align: left"><b> 2.3.1</b></td>
</tr>
</table>
</div>
</div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">splitter</span> <span class="o">=</span> <span class="n">ExpandingWindowSplitter</span><span class="p">(</span><span class="n">initial_train_window</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step_size</span><span class="p">)</span> 
</span></code></pre></div>
<h3 id="naive_1">Naive</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">Naive</span><span class="p">()</span>
</span><span id="__span-12-2"><a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a>
</span><span id="__span-12-3"><a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="n">scorecard</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">record_time</span><span class="p">(</span><span class="s1">'naive'</span><span class="p">,</span> <span class="s1">'fold (online)'</span><span class="p">)(</span><span class="n">train_evaluate</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splitter</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">BackendType</span><span class="o">.</span><span class="n">no</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-12-4"><a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="n">plot_y_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"overlap"</span><span class="p">)</span>
</span><span id="__span-12-5"><a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="n">scorecard</span><span class="p">[[</span><span class="s1">'rmse'</span><span class="p">]]</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'minimal'</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Run time: 0.17832120899998927 seconds
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="png" data-type="image" data-width="100%" href="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_26_1.png"><img alt="png" src="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_26_1.png"/></a></p>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">                                          predictions_Naive
                 Root Mean Squared Error        <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.224</span>      
</pre>
<h3 id="statsmodels-arima-online">Statsmodels ARIMA (Online)</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">WrapStatsModels</span><span class="p">(</span><span class="n">StatsModelARIMA</span><span class="p">,</span> <span class="n">init_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">online_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-2"><a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="n">scorecard</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">record_time</span><span class="p">(</span><span class="s1">'arima'</span><span class="p">,</span> <span class="s1">'fold (online)'</span><span class="p">)(</span><span class="n">train_evaluate</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splitter</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">BackendType</span><span class="o">.</span><span class="n">no</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-13-3"><a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="n">plot_y_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"overlap"</span><span class="p">)</span>
</span><span id="__span-13-4"><a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="n">scorecard</span><span class="p">[[</span><span class="s1">'rmse'</span><span class="p">]]</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'minimal'</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Run time: 41.32513004100002 seconds
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="png" data-type="image" data-width="100%" href="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_28_1.png"><img alt="png" src="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_28_1.png"/></a></p>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">                                          predictions_WrapStatsModels-type
                 Root Mean Squared Error                <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.927</span>             
</pre>
<h3 id="xgboost_1">XGBoost</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
</span><span id="__span-14-2"><a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-14-3"><a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="n">pipeline</span> <span class="o">=</span> <span class="p">[</span><span class="n">AddLagsX</span><span class="p">((</span><span class="s2">"all"</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">lag_length_for_tabular_models</span><span class="p">)))</span> <span class="p">),</span> <span class="n">model</span><span class="p">]</span>
</span><span id="__span-14-4"><a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a>
</span><span id="__span-14-5"><a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="n">scorecard</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">record_time</span><span class="p">(</span><span class="s1">'xgboost'</span><span class="p">,</span> <span class="s1">'fold (online)'</span><span class="p">)(</span><span class="n">train_evaluate</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">splitter</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">BackendType</span><span class="o">.</span><span class="n">ray</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-14-6"><a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="n">plot_y_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"overlap"</span><span class="p">)</span>
</span><span id="__span-14-7"><a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="n">scorecard</span><span class="p">[[</span><span class="s1">'rmse'</span><span class="p">]]</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'minimal'</span><span class="p">)</span>
</span></code></pre></div>
<p>This results in much more realistic simulation of past performance (in case the last value is available in production).</p>
<h3 id="results_1">Results</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">timing</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span></code></pre></div>
<div id="df-4f115e4a-e515-4317-af47-c984a43718d1">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: center;">
<th></th>
<th>sktime (long-fh)</th>
<th>fold (online)</th>
</tr>
</thead>
<tbody>
<tr>
<th>naive</th>
<td>0.329</td>
<td>0.180</td>
</tr>
<tr>
<th>arima</th>
<td>2.449</td>
<td>41.325</td>
</tr>
<tr>
<th>xgboost</th>
<td>44.591</td>
<td>13.256</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-4f115e4a-e515-4317-af47-c984a43718d1')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-4f115e4a-e515-4317-af47-c984a43718d1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4f115e4a-e515-4317-af47-c984a43718d1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<p>And it's also substantially faster, except in the case of Statsmodels' ARIMA, which <code>fold</code> needs to update on every timestamp. Our own ARIMA (coming in April) will provide a ca. 100x speedup here.</p>
<h2 id="sktime-short-forecasting-horizon-continuous-validation">SKTime - Short forecasting horizon (Continuous Validation)</h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">cv</span> <span class="o">=</span> <span class="n">SKTimeExpandingWindowSplitter</span><span class="p">(</span><span class="n">initial_window</span><span class="o">=</span><span class="n">initial_train_size</span><span class="p">,</span> <span class="n">step_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fh</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<p>Now let's see what SKTime's training speed would be like if we wanted to replicate "Continuous Validation", and the models having access to the latest value within the folds.</p>
<p>This means we'll need to update (not possible with the tested models) or fit a new model for every timestamp we return.</p>
<h3 id="naive_2">Naive</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="n">forecaster</span> <span class="o">=</span> <span class="n">NaiveForecaster</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">"last"</span><span class="p">)</span>
</span><span id="__span-17-2"><a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="n">results</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">record_time</span><span class="p">(</span><span class="s1">'naive'</span><span class="p">,</span> <span class="s1">'sktime (online)'</span><span class="p">)(</span><span class="n">evaluate</span><span class="p">,</span> <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">"refit"</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s1">'raise'</span><span class="p">)</span>
</span><span id="__span-17-3"><a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">flatten_result_windows</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">'y_pred'</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">"naive"</span><span class="p">)</span>
</span><span id="__span-17-4"><a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="n">plot_y_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"overlap"</span><span class="p">)</span>
</span><span id="__span-17-5"><a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="n">score</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)[[</span><span class="s1">'rmse'</span><span class="p">]]</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'minimal'</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Run time: 18.046849753999993 seconds
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="png" data-type="image" data-width="100%" href="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_39_1.png"><img alt="png" src="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_39_1.png"/></a></p>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">                                          naive
                 Root Mean Squared Error  <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.224</span>
</pre>
<h3 id="statsmodels-arima_1">Statsmodels ARIMA</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="kn">from</span> <span class="nn">sktime.forecasting.arima</span> <span class="kn">import</span> <span class="n">ARIMA</span>
</span><span id="__span-18-2"><a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="n">forecaster</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
</span><span id="__span-18-3"><a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a>
</span><span id="__span-18-4"><a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="n">results</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">record_time</span><span class="p">(</span><span class="s1">'arima'</span><span class="p">,</span> <span class="s1">'sktime (online)'</span><span class="p">)(</span><span class="n">evaluate</span><span class="p">,</span> <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s1">'raise'</span><span class="p">)</span>
</span><span id="__span-18-5"><a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">flatten_result_windows</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">'y_pred'</span><span class="p">])</span>
</span><span id="__span-18-6"><a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="n">plot_y_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"overlap"</span><span class="p">)</span>
</span><span id="__span-18-7"><a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="n">score</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)[[</span><span class="s1">'rmse'</span><span class="p">]]</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'minimal'</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>/usr/local/lib/python3.9/dist-packages/statsmodels/base/model.py:604: ConvergenceWarning:

Maximum Likelihood optimization failed to converge. Check mle_retvals



Run time: 106.65218957599996 seconds
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="png" data-type="image" data-width="100%" href="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_41_2.png"><img alt="png" src="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_41_2.png"/></a></p>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">                                          temperature
                 Root Mean Squared Error     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0.927</span>   
</pre>
<h3 id="xgboost_2">XGBoost</h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
</span><span id="__span-19-2"><a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="n">regressor</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-19-3"><a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a>
</span><span id="__span-19-4"><a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="n">forecaster</span> <span class="o">=</span> <span class="n">make_reduction</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s2">"recursive"</span><span class="p">,</span> <span class="n">window_length</span><span class="o">=</span><span class="n">lag_length_for_tabular_models</span><span class="p">)</span>
</span><span id="__span-19-5"><a href="#__codelineno-19-5" id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="n">results</span> <span class="o">=</span> <span class="n">timing</span><span class="o">.</span><span class="n">record_time</span><span class="p">(</span><span class="s1">'xgboost'</span><span class="p">,</span> <span class="s1">'sktime (online)'</span><span class="p">)(</span><span class="n">evaluate</span><span class="p">,</span> <span class="n">forecaster</span><span class="o">=</span><span class="n">forecaster</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">error_score</span><span class="o">=</span><span class="s1">'raise'</span><span class="p">)</span>
</span><span id="__span-19-6"><a href="#__codelineno-19-6" id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="n">predictions</span> <span class="o">=</span> <span class="n">flatten_result_windows</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">'y_pred'</span><span class="p">])</span>
</span><span id="__span-19-7"><a href="#__codelineno-19-7" id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="n">plot_y_predictions</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"overlap"</span><span class="p">)</span>
</span><span id="__span-19-8"><a href="#__codelineno-19-8" id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="n">score</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">predictions</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">predictions</span><span class="p">)[[</span><span class="s1">'rmse'</span><span class="p">]]</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">'minimal'</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>Run time: 759.161927353 seconds
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-title="png" data-type="image" data-width="100%" href="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_43_1.png"><img alt="png" src="../benchmarking_sktime_fold_files/benchmarking_sktime_fold_43_1.png"/></a></p>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">                                          temperature
                 Root Mean Squared Error     <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1.018</span>   
</pre>
<h2 id="overall-results">Overall Results</h2>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="n">timing</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</span></code></pre></div>
<div id="df-119838ec-fb8d-45ca-b033-1ee3de119a31">
<div class="colab-df-container">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: center;">
<th></th>
<th>sktime (long-fh)</th>
<th>fold (online)</th>
<th>sktime (online)</th>
</tr>
</thead>
<tbody>
<tr>
<th>naive</th>
<td>0.329</td>
<td>0.180</td>
<td>18.048</td>
</tr>
<tr>
<th>arima</th>
<td>2.449</td>
<td>41.325</td>
<td>106.653</td>
</tr>
<tr>
<th>xgboost</th>
<td>44.591</td>
<td>13.256</td>
<td>759.163</td>
</tr>
</tbody>
</table>
</div>
<button class="colab-df-convert" onclick="convertToInteractive('df-119838ec-fb8d-45ca-b033-1ee3de119a31')" style="display:none;" title="Convert this dataframe to an interactive table.">
<svg height="24px" viewbox="0 0 24 24" width="24px" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0V0z" fill="none"></path>
<path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"></path><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"></path>
</svg>
</button>
<style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>
<script>
        const buttonEl =
          document.querySelector('#df-119838ec-fb8d-45ca-b033-1ee3de119a31 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-119838ec-fb8d-45ca-b033-1ee3de119a31');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
</div>
</div>
<p>Overall, <a href="https://github.com/dream-faster/fold"><code>fold</code></a> provides a speedup between 3x and 100x, already.</p>
<p>When it comes to practice, we argue that this makes Continuos Validation feasible, compared to other tools out there.</p>
<form class="md-feedback" hidden="" name="feedback">
<fieldset>
<legend class="md-feedback__title">
        Was this page helpful?
      </legend>
<div class="md-feedback__inner">
<div class="md-feedback__list">
<button class="md-feedback__icon md-icon" data-md-value="1" title="This page was helpful" type="submit">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"></path></svg>
</button>
<button class="md-feedback__icon md-icon" data-md-value="0" title="This page could be improved" type="submit">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"></path></svg>
</button>
</div>
<div class="md-feedback__note">
<div data-md-value="1" hidden="">
              
              
                
              
              Thanks for your feedback!
            </div>
<div data-md-value="0" hidden="">
              
              
                
              
              Thanks for your feedback! Help us improve this page by using our <a href="..." rel="noopener" target="_blank">feedback form</a>.
            </div>
</div>
</div>
</fieldset>
</form>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Dream Faster 2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-consent" data-md-component="consent" hidden="" id="__consent">
<div class="md-consent__overlay"></div>
<aside class="md-consent__inner">
<form class="md-consent__form md-grid md-typeset" name="consent">
<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" id="__settings" type="checkbox"/>
<div class="md-consent__settings">
<ul class="task-list">
<li class="task-list-item">
<label class="task-list-control">
<input checked="" name="analytics" type="checkbox"/>
<span class="task-list-indicator"></span>
          Google Analytics
        </label>
</li>
<li class="task-list-item">
<label class="task-list-control">
<input checked="" name="github" type="checkbox"/>
<span class="task-list-indicator"></span>
          GitHub
        </label>
</li>
</ul>
</div>
<div class="md-consent__controls">
<button class="md-button md-button--primary">Accept</button>
<label class="md-button" for="__settings">Manage settings</label>
</div>
</form>
</aside>
</div>
<script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "search.suggest", "toc.follow", "navigation.top", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.c8d2eff1.min.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>